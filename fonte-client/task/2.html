<!DOCTYPE html>

<html lang="pt-br">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="Uma página para notação de vídeo.">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
<title>Notação de Vídeo</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-blue.min.css" />
<link rel="stylesheet" href="../pagina.css">
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<script src="../client.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

</head>

<body>
  <script>
    var client = new ClientJS();
    var fingerprint = client.getFingerprint();
  </script>

  <script>
    var legenda;
    var link;
    var op1;
    var op2;
    var op3;
    var op4;
    var op5;
    var id1;
    var id2;
    var id3;
    var id4;
    var id5;
    var iddovideo;
    var legendatotal;
    var legenda;
    var link;
    var dt = new Date();
    var anoinicial = dt.getFullYear();
    var mesinicial = dt.getMonth();
    var diainicial = dt.getDay();
    var horainicial = dt.getHours();
    var minutoinicial = dt.getMinutes();
    var segundoinicial = dt.getSeconds();
    var totaltempoinicial = anoinicial + '-' + mesinicial + '-' + diainicial + ' ' + horainicial + ':' + minutoinicial + ':' + segundoinicial;
    $.getJSON("http://46.101.129.171:8080/api/task2", function (key, result) {
      iddovideo = key.id_video;
      legendatotal = key.legenda;
      legenda = "Legenda Original: " + key.legenda_original;
      link = "http://46.101.129.171:8080/videos/" + key.id_video + ".mp4";
      $("#video").html('<source src="' + link + '" type="video/mp4"></source>');
      $('#legendatexto').html(legenda);
      if (key.legendas.length == '0') {
        $("#aparecer1").hide();
        $("#aparecer2").hide();
        $("#aparecer3").hide();
        $("#aparecer4").hide();
        $("#aparecer5").hide();
      }
      if (key.legendas.length == '1') {
        op1 = key.legendas[0].legenda;
        id1 = key.legendas[0].id;
        $("#texto1").text(op1);
        $("#aparecer2").hide();
        $("#aparecer3").hide();
        $("#aparecer4").hide();
        $("#aparecer5").hide();
      }
      if (key.legendas.length == '2') {
        op1 = key.legendas[0].legenda;
        id1 = key.legendas[0].id;
        id2 = key.legendas[1].id;
        $("#texto1").text(op1);
        op2 = key.legendas[1].legenda;
        $("#texto2").text(op2);
        $("#aparecer3").hide();
        $("#aparecer4").hide();
        $("#aparecer5").hide();
      }
      if (key.legendas.length == '3') {
        op1 = key.legendas[0].legenda;
        $("#texto1").text(op1);
        op2 = key.legendas[1].legenda;
        $("#texto2").text(op2);
        op3 = key.legendas[2].legenda;
        $("#texto3").text(op3);
        $("#aparecer4").hide();
        $("#aparecer5").hide();
        id1 = key.legendas[0].id;
        id2 = key.legendas[1].id;
        id3 = key.legendas[2].id;
      }
      if (key.legendas.length == '4') {
        op1 = key.legendas[0].legenda;
        $("#texto1").text(op1);
        op2 = key.legendas[1].legenda;
        $("#texto2").text(op2);
        op3 = key.legendas[2].legenda;
        $("#texto3").text(op3);
        op4 = key.legendas[3].legenda;
        $("#texto4").text(op4);
        $("#aparecer5").hide();
        id1 = key.legendas[0].id;
        id2 = key.legendas[1].id;
        id3 = key.legendas[2].id;
        id4 = key.legendas[3].id;
      }
      if (key.legendas.length == '5') {
        op1 = key.legendas[0].legenda;
        $("#texto1").text(op1);
        op2 = key.legendas[1].legenda;
        $("#texto2").text(op2);
        op3 = key.legendas[2].legenda;
        $("#texto3").text(op3);
        op4 = key.legendas[3].legenda;
        $("#texto4").text(op4);
        op5 = key.legendas[4].legenda;
        $("#texto5").text(op5);
        id1 = key.legendas[0].id;
        id2 = key.legendas[1].id;
        id3 = key.legendas[2].id;
        id4 = key.legendas[3].id;
        id5 = key.legendas[4].id;
      }



    });
  </script>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
    <header class="mdl-layout__header">
      <div class="mdl-layout__header-row">
        <span class="mdl-layout-title">Escolha de Legenda</span>
      </div>
    </header>
  </div>
  <br/><br/><br/><br/><br/>

  <center>

    <h5> Assista o vídeo abaixo, veja a legenda original, escolha a melhor tradução entre as opções e clique em "Enviar".</h5>

    <video id="video" controls autoplay preload="auto" width="55%" height="55%">

    </video>
    <h6 id="legendatexto"></h6>
    <label id="aparecer1" class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-1">
  <input type="radio" id="option-1" class="mdl-radio__button" name="options" value="1" checked>
  <span id="texto1" class="mdl-radio__label"></span>
</label>
    <br/>
    <label id="aparecer2" class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-2">
  <input type="radio" id="option-2" class="mdl-radio__button" name="options" value="2">
  <span id="texto2" class="mdl-radio__label"></span>
</label>
    <br/>
    <label id="aparecer3" class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-3">
  <input type="radio" id="option-3" class="mdl-radio__button" name="options" value="3">
  <span id="texto3" class="mdl-radio__label"></span>
</label>
    <br/>
    <label id="aparecer4" class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-4">
  <input type="radio" id="option-4" class="mdl-radio__button" name="options" value="4">
  <span id="texto4" class="mdl-radio__label"></span>
</label>
    <br/>
    <label id="aparecer5" class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-5">
  <input type="radio" id="option-5" class="mdl-radio__button" name="options" value="5">
  <span id="texto5" class="mdl-radio__label"></span>
</label>
    <br/>
    <button id="enviarid" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
  Enviar
</button>
  </center>
  <script>
    $("#enviarid").click(function () {
      var escolher = $("input:checked").val();
      var escolha=0;
      if(escolher=='1')
      {
        escolha=id1;
      }
      if(escolher=='2')
      {
        escolha=id2;
      }
      if(escolher=='3')
      {
        escolha=id3;
      }
      if(escolher=='4')
      {
        escolha=id4;
      }
      if(escolher=='5')
      {
        escolha=id5;
      }
      var dt2 = new Date();
      var anofinal = dt2.getFullYear();
      var mesfinal = dt2.getMonth();
      var diafinal = dt2.getDay();
      var horafinal = dt2.getHours();
      var minutofinal = dt2.getMinutes();
      var segundofinal = dt2.getSeconds();
       var totaltempofinal = anofinal + '-' + mesfinal + '-' + diafinal + ' ' + horafinal + ':' + minutofinal + ':' + segundofinal;
      var enviar= JSON.stringify({"id_video":iddovideo, "id_legenda_escolhida":escolha, "tinicial":totaltempoinicial, "tfinal":totaltempofinal, "fingerprint":fingerprint});
     $.ajax({
          type: 'POST',
          async: false,
          url: 'http://46.101.129.171:8080/api/task2',
          data: enviar,
          contentType: "application/json",
          dataType: 'json'
        });


      $(window).attr("location", "../index.html");


    });

  </script>

</body>

</html>